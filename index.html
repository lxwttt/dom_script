<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>尘白禁区疗愈计算器</title>
    <script>
        async function optimize() {
            // Clear previous output and show loading message
            document.getElementById('result').innerText = 'Loading...';

            const v = document.getElementById('v').value.split(',').map(Number);
            console.log(v);
            const edges = document.getElementById('edges').value.match(/\d+,\d+/g).map(pair => pair.split(',').map(Number));
            const weight = parseFloat(document.getElementById('weight').value);

            const response = await fetch('/optimize', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ v, edges, weight }),
            });

            const result = await response.json();
            if (response.ok) {
                const formattedResult = `
                    最后结果: ${result.resulting_vector.join(', ')}\n
                    按: ${result.w_1.join(', ')}\n
                    锤: ${result.w_2.join(', ')}\n
                    估算需要体力: ${result.weight_sum}
                `;
                document.getElementById('result').innerText = formattedResult;
            } else {
                document.getElementById('result').innerText = 'Error: ' + result.error;
            }
        }
    </script>
</head>
<body>
    <h1>尘白禁区疗愈计算器</h1>
    <p>输入初始压力、边、单位消耗体力，输出每个点需要按、锤的数量</p>
    <p>0 代表红色，1代表黄色，2代表绿色</p>
    <label for="v">初始压力:</label>
    <input type="text" id="v" value="0,0,0,1,1,0"><br><br>
    <p>输入格式为 (i,j);(j,k),默认按输入顺序相邻的两个点已连接（点编号从0开始）</p>
    <label for="edges">边:</label>
    <input type="text" id="edges" value="(0,2);(3,5)"><br><br>
    <p>从黄色按至绿色消耗的体力百分比，0级时约0.135，4级时约0.105</p>
    <label for="weight">单位消耗体力:</label>
    <input type="text" id="weight" value="0.105"><br><br>
    <button onclick="optimize()">计算策略</button>
    <pre id="result"></pre>
</body>
</html>
